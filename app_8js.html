<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Global Lender: src/js/app.js File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="Horizon Logo~chalk.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Global Lender
   </div>
   <div id="projectbrief">A Pebble app for finding new and interesting loans on kiva.org</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_3dcea8250b5ce8d5bc595fbbad3e8f21.html">js</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">app.js File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a8464c96f809401451da612058236c594"><td class="memItemLeft" align="right" valign="top">function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="app_8js.html#a8464c96f809401451da612058236c594">callKivaApiAsync</a> (url, parseFxn, maxResults)</td></tr>
<tr class="separator:a8464c96f809401451da612058236c594"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6502f909d3cd81be1b6ed9339cb92ab"><td class="memItemLeft" align="right" valign="top">function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="app_8js.html#ac6502f909d3cd81be1b6ed9339cb92ab">getLenderInfo</a> ()</td></tr>
<tr class="separator:ac6502f909d3cd81be1b6ed9339cb92ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0349825e466fa95d3410e48f75107ef7"><td class="memItemLeft" align="right" valign="top">function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="app_8js.html#a0349825e466fa95d3410e48f75107ef7">getLoansForLender</a> ()</td></tr>
<tr class="separator:a0349825e466fa95d3410e48f75107ef7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8b0faa37afaf571b79185b4910365b2e"><td class="memItemLeft" align="right" valign="top">function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="app_8js.html#a8b0faa37afaf571b79185b4910365b2e">getPreferredLoans</a> (prefCC, maxResults)</td></tr>
<tr class="separator:a8b0faa37afaf571b79185b4910365b2e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a412e80b9aefa6434f6a35cd2dd27398f"><td class="memItemLeft" align="right" valign="top">Pebble&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="app_8js.html#a412e80b9aefa6434f6a35cd2dd27398f">addEventListener</a> ('appmessage', function(e){console.log(&quot;AppMessage received: &quot;+JSON.stringify(e.payload));var dict=e.payload;if('<a class="el" href="comm_8h.html#ad4843d812d90ec4f7e8726a2755f8e7ca5b543121157fee3fa2afd3e3cb0d06da">KEY_GET_LENDER_INFO</a>'in dict){<a class="el" href="app_8js.html#ac6502f909d3cd81be1b6ed9339cb92ab">getLenderInfo</a>();<a class="el" href="app_8js.html#a0349825e466fa95d3410e48f75107ef7">getLoansForLender</a>();}else if('<a class="el" href="comm_8h.html#ad4843d812d90ec4f7e8726a2755f8e7cac80e553fa2772d56e66751b8e5dc4775">KEY_GET_PREFERRED_LOANS</a>'in dict){var prefCC=dict['<a class="el" href="comm_8h.html#ad4843d812d90ec4f7e8726a2755f8e7cac80e553fa2772d56e66751b8e5dc4775">KEY_GET_PREFERRED_LOANS</a>'];var maxResults=10;<a class="el" href="app_8js.html#a8b0faa37afaf571b79185b4910365b2e">getPreferredLoans</a>(prefCC, maxResults);}else{console.log(&quot;Unrecognized app message: &quot;+JSON.stringify(dict));}})</td></tr>
<tr class="memdesc:a412e80b9aefa6434f6a35cd2dd27398f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Listen for when an AppMessage is received.  <a href="#a412e80b9aefa6434f6a35cd2dd27398f">More...</a><br /></td></tr>
<tr class="separator:a412e80b9aefa6434f6a35cd2dd27398f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ae55147f775040cba33aa39fe52ce5a42"><td class="memItemLeft" align="right" valign="top">var&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="app_8js.html#ae55147f775040cba33aa39fe52ce5a42">kivaCC</a> = {}</td></tr>
<tr class="separator:ae55147f775040cba33aa39fe52ce5a42"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a203e9d218c27851765106c4236a13a09"><td class="memItemLeft" align="right" valign="top">var&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="app_8js.html#a203e9d218c27851765106c4236a13a09">baseKivaUrl</a> = &quot;http://api.kivaws.org/v1/&quot;</td></tr>
<tr class="separator:a203e9d218c27851765106c4236a13a09"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a521195d84112f11fa6a94864d942e2f2"><td class="memItemLeft" align="right" valign="top">var&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="app_8js.html#a521195d84112f11fa6a94864d942e2f2">jsonExt</a> = &quot;.json&quot;</td></tr>
<tr class="separator:a521195d84112f11fa6a94864d942e2f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca27c5aeb2c7a53c422651acbed41d64"><td class="memItemLeft" align="right" valign="top">var&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="app_8js.html#aca27c5aeb2c7a53c422651acbed41d64">kivaAppId</a> = 'com.magnosity.global-lender'</td></tr>
<tr class="separator:aca27c5aeb2c7a53c422651acbed41d64"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c4e967627ef2f5784f60cd1ad02267d"><td class="memItemLeft" align="right" valign="top">var&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="app_8js.html#a8c4e967627ef2f5784f60cd1ad02267d">kivaAppIdParam</a> = &quot;appId=&quot; + kivaAppId</td></tr>
<tr class="separator:a8c4e967627ef2f5784f60cd1ad02267d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e4bf1d89e1aae83b014c99c4dfeacc3"><td class="memItemLeft" align="right" valign="top">var&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="app_8js.html#a5e4bf1d89e1aae83b014c99c4dfeacc3">lenderId</a> = 'jdb'</td></tr>
<tr class="separator:a5e4bf1d89e1aae83b014c99c4dfeacc3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2021cfe05b76494e9da6899b136dbda0"><td class="memItemLeft" align="right" valign="top">var&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="app_8js.html#a2021cfe05b76494e9da6899b136dbda0">pageArray</a> = []</td></tr>
<tr class="separator:a2021cfe05b76494e9da6899b136dbda0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4278121f2146f44a9896ca0d9a46c827"><td class="memItemLeft" align="right" valign="top">Array prototype&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="app_8js.html#a4278121f2146f44a9896ca0d9a46c827">unique</a></td></tr>
<tr class="memdesc:a4278121f2146f44a9896ca0d9a46c827"><td class="mdescLeft">&#160;</td><td class="mdescRight">Array extension to return the unique values of an array.  <a href="#a4278121f2146f44a9896ca0d9a46c827">More...</a><br /></td></tr>
<tr class="separator:a4278121f2146f44a9896ca0d9a46c827"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a95e8ee81171c3c0c9478b89a196ee90b"><td class="memItemLeft" align="right" valign="top">var&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="app_8js.html#a95e8ee81171c3c0c9478b89a196ee90b">xhrRequest</a></td></tr>
<tr class="separator:a95e8ee81171c3c0c9478b89a196ee90b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a412e80b9aefa6434f6a35cd2dd27398f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Pebble addEventListener </td>
          <td>(</td>
          <td class="paramtype">'ready'&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">function(e){console.log(&quot;PebbleKit JS ready!&quot;);Pebble.sendAppMessage({&quot;KEY_PEBKIT_READY&quot;:1});getKivaActiveFieldPartners();}&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Listen for when an AppMessage is received. </p>
<p>Listen for when the watch opens communication and inform the watch that the PebbleKit end of the channel is ready. </p>

</div>
</div>
<a class="anchor" id="a8464c96f809401451da612058236c594"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">callKivaApiAsync </td>
          <td>(</td>
          <td class="paramtype">url&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">parseFxn&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">maxResults&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Calls the Kiva API web service, parsing results by calling the function passed in as parseFxn. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">url</td><td>URL of the webservice </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">parseFxn</td><td>Function that returns a dictionary of key/value pairs that represent the information that must be passed back to the Pebble watch. Function should expect to receive an array of JSON objects (range = [0 .. n-1 pages]), one value for each page. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">maxResults</td><td>Predetermined limit to the number of results we need to fetch from the webservice. If maxResults is zero, then all results will be fetched. (If zero results is really desired, then don't call this function!) </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ac6502f909d3cd81be1b6ed9339cb92ab"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">function getLenderInfo </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a0349825e466fa95d3410e48f75107ef7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">function getLoansForLender </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a8b0faa37afaf571b79185b4910365b2e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">function getPreferredLoans </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>prefCC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>maxResults</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="a203e9d218c27851765106c4236a13a09"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">var baseKivaUrl = &quot;http://api.kivaws.org/v1/&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a521195d84112f11fa6a94864d942e2f2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">var jsonExt = &quot;.json&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="aca27c5aeb2c7a53c422651acbed41d64"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">var kivaAppId = 'com.magnosity.global-lender'</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a8c4e967627ef2f5784f60cd1ad02267d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">var kivaAppIdParam = &quot;appId=&quot; + kivaAppId</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ae55147f775040cba33aa39fe52ce5a42"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">var kivaCC = {}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a5e4bf1d89e1aae83b014c99c4dfeacc3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">var lenderId = 'jdb'</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a2021cfe05b76494e9da6899b136dbda0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">var pageArray = []</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a4278121f2146f44a9896ca0d9a46c827"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Array prototype unique</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= <span class="keyword">function</span>() {</div><div class="line">    var a = [], l = this.length;</div><div class="line">    <span class="keywordflow">for</span>(var i=0; i&lt;l; i++) {</div><div class="line">      <span class="keywordflow">for</span>(var j=i+1; j&lt;l; j++)</div><div class="line">            <span class="keywordflow">if</span> (<span class="keyword">this</span>[i] === <span class="keyword">this</span>[j]) j = ++i;</div><div class="line">      a.push(<span class="keyword">this</span>[i]);</div><div class="line">    }</div><div class="line">    <span class="keywordflow">return</span> a;</div><div class="line">}</div></div><!-- fragment -->
<p>Array extension to return the unique values of an array. </p>

</div>
</div>
<a class="anchor" id="a95e8ee81171c3c0c9478b89a196ee90b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">var xhrRequest</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= <span class="keyword">function</span> (method, url, callback) {</div><div class="line">  var xhr = <span class="keyword">new</span> XMLHttpRequest();</div><div class="line">  xhr.onload = <span class="keyword">function</span> () {</div><div class="line">    callback(this.responseText);</div><div class="line">  };</div><div class="line">  xhr.onerror = <span class="keyword">function</span>() {</div><div class="line">    console.log(<span class="stringliteral">&quot;HTTP &quot;</span> + xhr.status + <span class="stringliteral">&quot; ERROR: &quot;</span> + xhr.statusText);</div><div class="line">    </div><div class="line">  };</div><div class="line">  xhr.ontimeout = <span class="keyword">function</span>() {</div><div class="line">    console.log(<span class="stringliteral">&quot;HTTP TIMEOUT for &quot;</span> + url);</div><div class="line">    </div><div class="line">  };</div><div class="line">  xhr.timeout = 10000;  </div><div class="line">  xhr.open(method, url);</div><div class="line">  xhr.send();</div><div class="line">}</div></div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
